import time
import schedule
from json import dumps
from kafka import KafkaProducer

kafka_nodes = "kafka:9092"
my_topic = "arabic_reviews"

# List of Dummy reviews
arabic_reviews = text_list = [
    "ููุชุงุฒ",
    "ุดูุฑุง ููู ูู ุงูุงุนูุงู",
    "ูููุณู ุงููุญุฏู ูุงูู ุฎุฏูุงุช ูุงููู",
    "ููููู ุงููู",
    "โฆ..",
    "ููุชุงุฒ",
    "ุงูุญูุฏููู",
    "ุดูุฑุง",
    "ุดูุฑุง",
    "ุชุบููุฑ ุงููุญุฏุฉ ุงูุณูููุฉ",
    "ุดูุฑุงู ููู",
    "ูู ุดู ุชูุงู",
    "ููุชุงุฒ ุฌุฏุงู",
    "ุฌุฒุงูู ุงููู ุฎูุฑ",
    "ูุง ููุฌุฏ",
    "ููุชุงุฒ",
    "ุงุฑุฌูุง ูุณุงุนุฏุชู ุจุงููุฑุด ูุทูู ูุทุจุฎ ูุบุฑูู ููู ูุบุงุฒ ูุซูุงุฌู ููุฑู ูุบุณุงูู",
    "ุงูุฏ ุงูุฏู ูุฏุนู ุงูุงุซุงุซ",
    "ุฎุฏูู ููุชุงุฒู ููุงูุตุฑุชู",
    "ูุนุทููู ุงูุนุงููู",
    "ุชุนุงูููู ุฌุฏุงู ุฑุงูู",
    "ูุงููุฌุฏ",
    "ุงุงุง",
    "ุดูุฑุง ููู",
    "ููุชุงุฒ",
    "ุฑุงุถู",
    "ุดูุฑุง ุนูู ุงููุญุฏุฉ ุงูุณูููุฉ",
    "ุดูุฑุง ููู ูุฌุฒุงูู ุงููู ุฎูุฑ",
    "ูู ุงุณุชูู ุงููุญุฏู ููุงู",
    "?",
    "ุฃุฑุฌู ุฒูุงุฏุฉ ุนุฏุฏ ุงูุบุฑู ูุงูู ูุฏู  ุงุจูุชุงู ูููุฏุงู  ูุงูุง ูุฒูุฌู ูุงูููุฌูุฏ ุบุฑูุชุงู ููุฌูุณ ุฎุงุฑุฌู",
    "ุฌููู",
    "ููุชุงุฒ",
    "ูู ุดุฆ ููุชุงุฒ ูุนุทููู ุงูุนุงููู ุฌููุนุงุง ุฌุฒุงูู ุงููู ุฎูุฑ ุงูุฌุฒุงุก",
    "ุงูุณุคุงู ุนู ุตูุงูุฉ ุงููุญุฏุฉ",
    "ุดูุฑุง",
    "ููุชุงุฒ",
    "ุญุชู ุงูุงู ูุงุดูุช ุงู ุงุญุฏ ุฒุงุฑูู ุงููุญุฏู ููุง ุงุนุฑู ุงู ููุฏูุจ ุงูููุฏูุจ ุงููุฏูู ุตุงุฑ ูุตููู ููู ูุฒูุฑูู ุงู ููุฏูุจ",
    "ุงููููุน ุณูุฆ ุฌุฏูุง ููุง ููุฌุฏ ูุฏุงุฑุณ ูุฌูุงูุน ูุฑูุจู ูุงุฑุบุจ ุจุงูููู ูู ุงูุณูู ูู ุฌุฏุฉ ุงูู ุณูู ูู ููุฉ ุงูููุฑูุฉ ุงุฑุฌูุง ุงููุณุงุนุฏุฉ",
    "ุฌููู ุฌุฏุง",
    "ุงูุฑุฌุงุก ุงูุชูุงุตู ูุนู ุจุงูุฑุจ ููุช ูุงุงุณุชูุงู ููุชุงุชูุญ ุงููุญุฏุฉ ุงูุณูููุฉ",
    "ุดูุฑุงู",
    "ุฌูุฏ",
    "ุดูุฑุง",
    "ูู ุงุณุชูู ุงููุญุฏุฉ ุญุชู ูุง ุงูุญุธู",
    "ุฅุฒุนุงุฌ ุงูุฌูุฑุงู",
    "ููุชุงุฒู",
    "ูุง ููุฌุฏ",
    "ูู ุงุณุชูู ูุญุฏุฉ ุณูููุฉ ุงุทูุงูุง",
    "ุดูุฑุง",
    "ุดูุฑุง ุฌุฒููุง ููู",
    "ุตูุงูู ุงููุญุฏ ูุจู ุงูุชุณููู ุนุดุงู ุงูุฏููู ุงุดุชุฑุช ุงููุญุฏู ูููุง ุนููุจ",
    "ุดูุฑู",
    "ููุชุงุฒ ูุฑุงุถู ุฌุฏุง",
    "ุงูุณุจุงูุฉ ู ุงูุณุฎุงูุงุช ุชุญุชุงุฌ ุตูุงูุฉ ูุนุฏู ุนูููุง ุจุดูู ุฌูุฏ",
    "ูุงููุฌุฏ",
    "ููุชุงุฒ",
    "ุดูุฑุง ุนูู ูู ุดู ุชูุฏูููู ููููุงุทู ุงูุณุนูุฏู",
    "ุฌูุฏู",
    "ุดูุฑุงู ููู ุนูู ุฌููุฏูู",
    "ุงููู ูุฌุฒุงูู ูู ุฎูุฑ ููุนุฒุน ุฎุงุฏู ุงูุญุฑููู ุงูุดุฑูููู ูููู ุนูุฏ ูุงุฑุจ",
    "ุชุทููุฑ ุฎุฏูุงุช ุงูุงุณูุงู ูุชูููุฑ ูุฏุงุฑุณ ููุณุชูุตูุงุช ูุฎุฏูุงุช",
    "ุฌูุฏ",
    "ุชูุงู ุงูุญูุฏ ููู ูุงุฑุจ",
    "ูู ุดู ุชูุงู",
    "ูู ุดู ุฌูุฏ",
    "ููุชุงุฒ ุฌุฏุง ููู ุจุนุถ ุงูุดุฑูุท ูุนูุฏุฉ (ูู ุชุญุณูู ุงูุจูุช",
    "ุงู ูููู ูุณุงุญู ููุงุณุจู ุงูุงูุฑุงุฏ ุงูุงุณุฑู",
    "ููุชุงุฒู",
    "ุดูุฑุง ูุฏุนููู",
    "ุงูุชุธุฑุช ูู ุณูู ููู ุชุนุจุช ูููููู ุญุงููุง ูู ุงูุฑูุงุถ",
    "ุฌุฒุงูู ุงููู ุฎูุฑ",
    "ุฃูุง ุนูุฏู ูุดุงูู ุจุธูุฑ ููุงุงูุฏุฑ ุงูุตุนูุฏ ุงูุฏุฑุฌ ูุนูุฏู ุชูุฑูุฑ ุทุจู. ูุญุชุงุฌ ุดูู ุงุฑุถู. ููุงุณู ุงุนุทููู ุดูู ุฏูุฑ ุซุงูู",
    "ููุชุงุฒ",
    "ุงุณุงู ุงููู ููู ุงูุชูููู ูุงููุฌุงุญ",
    "ุงูุดูู ูู ุดูุก ุฎุฑุจุงู ููุง ุงููู ุจุชุตููุญ ุงููุทูุฑ ูุงูุฏูุดุงุช ูุบูุฑ ุฐุง ุฑูุญุฉ ุงูุดูู ุงูุฑููู ุงููู ุจูุงุฑุฑุฑู ูุฑุฑุฑู",
    "ูุงุจุฏ ูู ุฅุตูุงุญ ุงูุนููุจ ูู ุงููุญุฏุฉ ุงูุณูููุฉ ุนูู ูุฌู ุงูุณุฑุนุฉ",
    "ุฑุงุถู ุชูุงู",
    "ูุญุฏุฉ ุฌูููู ูููุงุณุจู",
    "ูุงููุฌุฏ ููุงุญุธุงุช",
    "ุธฺพุฑุช ูู ูุดุงูู ูุซูุฑฺพ ูู ุงููุญุฏฺพ ููู ุงุฌุฏ ูู ูููุฏูู ูู ููุถูุน ุงููุญุฏฺพ",
    "ูุงููุฌุฏ ููุงุญุธุงุช",
    "ูุชุงุฒ",
    "ุงูู ุงูุงู ูู ุงุณุชูู ุงููุญุฏุฉ ุงูุณูููุฉ",
    "ูุงุจุฏ ูู ูุฌูุฏ ุฃูุซุฑ ูู ุฏูุฑุฉ ููุงู ูุชูููุฑ ูููุฉ ุงูููุงู ุงููุณุชููู ููู ูุญุฏู",
    "ุฃุชููุง ููู ุงูุชูุฏู ูุงูุงุฒุฏูุงุฑ ูุงููุฌุงุญ ุงูุฏุงุฆู",
    "ููุชุงุฒ ุฌูุฏ",
    "ุฎุฏูุชู ุนูุฏ ุญุณู ุงูุธู",
    "ููุฑู ูุฏุงุฑุณ ุงููู ูุฑุถู ุนูููู",
    "ุซูุงุซ ุบุฑู ูุญูุง 11",
    "ุชูููุฑ ููุงุตูุงุช",
    "ุฑุงุถ ุนู ุงูุฎุฏูุฉ",
    "ููุชุงุฒ",
    "ููุชุงุฒู",
    "ูู ุดู ูุงู ููุชุงุฒ",
    "ุนุฏุฏ ุงูุงุณุฑู ูุจูุฑ ูุงูุดูู ุตุบูุฑู ุนูู ุนุฏุฏูู",
    "ุงุดูุฑูู",
    "ูุงุนุทููุง ูุงูุชุญ ุดูู",
    "ุดูุฑุง ููู",
    "ุงูุญูุฏููู ุนูู ุนุทุงูุงู",
    "ูุงุฒู ููุฌุฏ ุนูุฏ ุงููุญุฏุงุช ุงูุณูููู ูุณุงุฌุฏ ูุณูุจุฑ ูุงุฑูุช ูุญุฏุงุฆู ุชููู ูุฑูุจู ูู ุฌููุน ุงููุญุฏุงุช",
    "ุฎุฏูุงุช ุงูุตูุงูู ูุงูุชุฌุงูุจูู ูุน ูุซุฑุฉ ุงูุงุชุตุงู ุจูู",
    "ุงูุญูุฏ ููู ุจูุถู ุงููู ูู ุดู ููุชุงุฒ ุจุณ ุงุญุชุงุฌ ุตูุงูู ููููุฑุจุงุก ูุงูููุงุตูุฑ ุงููุงุก ูุดุงูุฑูู ุญุณู ุชุนุงูููู ููุงููู ุงูุชูููู ูุงููุฌุงุญ ุงูุฏุงุฆู ๐คฒโค๏ธ",
    "ุฑุงุถู.",
    "ูุง ููุฌุฏ ุดู",
    "ูู ุชูุงุณุจ ุงุนุฏุงุฏ ุงูุฑุงุฏ ุงูุงุณุฑู",
    "ููุชุงุฒ",
    "ููุญูู ูุงุนุทููุง ุงูููุชุงุญ",
    "ููุชุงุฒุฉ",
    "ุงููุณุท ุงูุดูุฑู",
    "ูุฏู ูุดููู ูุงูุง ูู ุงุณูู ุจุนุฏ ููุจุฏู ุงููู ูู ุงุณูู ูููุง ุงุฑุฌู ุงูุงูุชูุงู ูุงูุชูุงุตู ูุนู",
    "ูุงุจุฏ ุชูููุฑ ูุฏุฑุณู ูู ุงููููุน",
    "ูู ุดู ููุชุงุฒ ูุทูุน ูู ูุณุชูุตู ุญู ูุฒูุงุฏุฉ ูุฏุงุฑุณ",
    "ูุดูุฑูู ุน ุญุณู ุงูุชุนุงูู",
    "ููุชุงุฒู",
    "ุฑุงู ุงู ุชููู ุงููุญุฏู ุชุบุทู ุนุฏุฏ ุงูุงุณุฑู ุงูููููุญ ููุง ุงูุณูู ูุงู ุชุชููุฑ ุงูุฎุฏูุงุช ูุงุงููุฏุงุฑุณ ููุญูู",
    "ูู ุงุณุชูู ุงููุญุฏู. ูู  ูุงููุงุฑุจ. ุดูุฑ ูููุนู ุนูู ุงูุนูุงุฑู. ููุงูู ูู ุงุณุชูู ุงููุญุฏู ุงูุณูููู",
    "ูู ุงุณุชูู ุงููุญุฏู ุงูุณููููุ",
    "ูู ุดู ุชูุงู ุงูุญูุฏ ููู",
    "ุฌุฒุงูู ุงููู ุฎูุฑ",
    "ูุฑูุฏ ุฑูู ุงูุตูุงูู ุงูุฃูุถู",
    "ููุนุช. ุงูุนูุฏุงุก ููุง ุญุฏ ุงูุงู ูุณุชููุช ุงูููุชุงุญู",
    "ุชูููุฑ ุตูุงูู ุถุฑูุฑู",
    "ูุงููุฌุฏ ุฎุฏูู ุงูุตุฑู ุงูุตุญู ููุง ููุงู",
    ".",
    "ููุชุงุฒ",
    "ูุงูุจู ุงููุญุฏู ุฃุฑูุฏ ุชุณููููุง ูุง ููุฌุฏ ููุงู ูููุง ููุฌูุฑุงู ููุถูู ุฌุฏุข",
    "ุงุชููู ุชุฌุงูุจ ุนูุงู ุงูุตูุงูู ูุนูุง",
    "ููุชุงุฒ",
    "ุจุงุฑู ุงููู ูู ุฌููุฏูู ุฌููุนุง",
    "ุดูุฑุง",
    "ููุชุงุฒู",
    "ู ูููุช",
    "ุงูุชุดุทูุจ ุบูุฑ ููุงุณุจ ููุงููุฌุฏ ุฏูููุฑุงุช ุฌุจุณ ูููุจุงุช ูุฎุฒุงู ูุณุชูู ุงุฑุถู ูููู",
    "ููุชุงุฒู",
    "ููุชุงุฒุฉ",
    "ููุชุงุฒ",
    "ุงูุดูุฑูู ุนูู ุงููุณุงุนุฏู",
    "ููู ูุตุนุฏ ููุงุฒู ูุฏูุน ูู ูุชููู ุนุฏู ุงูุฏูุน ูููุตุนุฏ ูุงููุงุก ูุงูููุฑุจุงุก",
    "ุชู ุชูููุน ุงูุนููุฏ  ููู ุงุณุชูู ุงููุญุฏู  ุญุชู ูุงุฐู ุฃูุญุธู",
    "ุดุงูุฑู ููู ุฌููุฏูู ูุงูุชูุงููู ุงุชููู ูู ุงูุชูููู ูุงููุฌุงุญ ุงูุฏุงุฆู",
    "ุฌุฒุงูู ุงููู ูู ุงูุฎูุฑูุงูุนูุถ ุงูุฌููู ูู ุงููู ุจุณ ูุฐุงูุจูุช ุงูุนูุฑุงูุบุฑู ููููู ูุนุฏุฏุงูุงูุฑุงุฏูุงุดุงุกุงููู ูุงููู ุงูุงุจุงููู ููุงููุฌุฏูุชุญู ุงููููุฑุงูุจููููู ุงูุญูุด ูุชุบูุฑุงูููุณูู ุงุชููู ุงู ุงุบูุฑุงููุญุฏู ุงูุณูููู ุจุดูู ุงูุจุฑูุงููู ููุฑููู ุจูุนูู ุงูุฏููุงูุงูุงุฎุฑู ุดูุฑุงู",
    "ุดุฑูุฉ ุงูุตูุงูุฉ ูู ุชุชุฌุงูุจ ูู ูุง ูุฎุต ุฏุด ุงูุชููุฒููู.    ูุฑูุฏ ุชูุตูู ููุงู ุงูุญูููุฉ ุชุนุจูุง ูู ุงููุงูุชุงุช ูุตุฑูู ูุญุงูู",
    "ุงุฑุบุจ ุจุงุฑุฌุงุน ุงููุญุฏู ูุงููุฌุฏ ูุฏุงุฑุณ ููุงุทูุงู ูุงูุทุฑูู ูุนุฑ ูููุตูู",
    "ููุชุงุฒู",
    "ุชู",
    "ุดูุฑุง ููู",
    "ุนูุฏู ูุดููู ุจุงุฑูุจ ุฏุด ุดุงูุฑ ุจุญูุงู ูููู ุจูุงุท ุฒุงูุฏ ุนูุฏูุง  ูุงูุญุงุฑุณ ุฑุงูุถ ูุนุทููู ูููู ุฎูุฐู ุจูุงุท ุจูููุณ ูุนูููู ูู ูุฐุง ุฒุงูุฏ ุฒุงูุฏ ุฃุฑุฌู ุงูุงูุชูุงู ุจููุถูุนู ูุงูุฑุฏ ุนูู ุงููู ูุณุนุฏูู ูุงุฑุจ",
    "ูู ูุณุชูู ููุชุงุญ ุงูุณูู",
    "ุดูุฑุง"
]

def send_review():
    """Sends an Arabic review to Kafka."""
    try:
        producer = KafkaProducer(bootstrap_servers=kafka_nodes, value_serializer=lambda x: dumps(x).encode('utf-8'))
        for review in arabic_reviews:
            data = {"review": review}
            print(data)
            producer.send(my_topic, value=data)
            producer.flush()
            time.sleep(1)  # small delay between sending reviews
    except Exception as e:
        print(f"Error sending data to Kafka: {e}")

if __name__ == "__main__":
    schedule.every(30).seconds.do(send_review)
    
    while True:
        schedule.run_pending()
        time.sleep(1)